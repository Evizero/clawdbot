{
  "id": "msteams-call",
  "uiHints": {
    "enabled": {
      "label": "Enable MS Teams Voice Calls"
    },
    "bridge.secret": {
      "label": "Bridge Secret",
      "sensitive": true,
      "help": "Shared secret for C# gateway authentication (min 32 chars)"
    },
    "serve.port": {
      "label": "Bridge Port",
      "advanced": true
    },
    "serve.bind": {
      "label": "Bridge Bind Address",
      "advanced": true
    },
    "serve.path": {
      "label": "Bridge WebSocket Path",
      "advanced": true
    },
    "authorization.mode": {
      "label": "Authorization Mode"
    },
    "authorization.allowFrom": {
      "label": "Allowed Users/UPNs"
    },
    "authorization.allowedTenants": {
      "label": "Allowed Tenant IDs"
    },
    "authorization.allowPstn": {
      "label": "Allow PSTN Calls",
      "advanced": true
    },
    "inbound.enabled": {
      "label": "Enable Inbound Calls"
    },
    "inbound.greeting": {
      "label": "Inbound Greeting"
    },
    "outbound.enabled": {
      "label": "Enable Outbound Calls"
    },
    "outbound.ringTimeoutMs": {
      "label": "Ring Timeout (ms)",
      "advanced": true
    },
    "outbound.defaultMode": {
      "label": "Default Call Mode"
    },
    "tts.model": {
      "label": "TTS Model",
      "advanced": true
    },
    "tts.voice": {
      "label": "TTS Voice",
      "advanced": true
    },
    "tts.instructions": {
      "label": "TTS Instructions",
      "advanced": true
    },
    "tts.speed": {
      "label": "TTS Speed",
      "advanced": true
    },
    "streaming.openaiApiKey": {
      "label": "OpenAI API Key",
      "sensitive": true,
      "advanced": true
    },
    "streaming.sttModel": {
      "label": "STT Model",
      "advanced": true
    },
    "streaming.silenceDurationMs": {
      "label": "Silence Duration (ms)",
      "advanced": true
    },
    "streaming.vadThreshold": {
      "label": "VAD Threshold",
      "advanced": true
    },
    "streaming.sentenceMinChars": {
      "label": "Min Chars Before Break",
      "advanced": true
    },
    "streaming.sentenceMaxChars": {
      "label": "Max Chars Per Chunk",
      "advanced": true
    },
    "streaming.maxParallelTTS": {
      "label": "Max Parallel TTS Jobs",
      "advanced": true
    },
    "streaming.jitterBufferFrames": {
      "label": "Jitter Buffer Frames",
      "advanced": true
    },
    "streaming.thinkLevel": {
      "label": "Thinking Level",
      "advanced": true
    },
    "streaming.endOfTurnCue": {
      "label": "End of Turn Audio Cue",
      "advanced": true
    },
    "streaming.ttsMode": {
      "label": "TTS Mode",
      "advanced": true,
      "help": "realtime: Uses Realtime API as agent (single LLM), chunked: Uses Pi agent + REST TTS"
    },
    "realtime.model": {
      "label": "Realtime Model",
      "advanced": true
    },
    "realtime.voice": {
      "label": "Realtime Voice",
      "advanced": true
    },
    "realtime.turnDetection.type": {
      "label": "Turn Detection Mode",
      "advanced": true
    },
    "realtime.turnDetection.threshold": {
      "label": "VAD Threshold (Realtime)",
      "advanced": true
    },
    "realtime.turnDetection.silenceDurationMs": {
      "label": "Silence Duration (Realtime)",
      "advanced": true
    },
    "realtime.maxSessionDurationMs": {
      "label": "Max Session Duration (ms)",
      "advanced": true,
      "help": "OpenAI Realtime API has 15min limit. Default: 14min (840000ms)"
    },
    "responseModel": {
      "label": "Response Model",
      "advanced": true
    },
    "responseSystemPrompt": {
      "label": "Response System Prompt",
      "advanced": true
    },
    "responseTimeoutMs": {
      "label": "Response Timeout (ms)",
      "advanced": true
    },
    "maxConcurrentCalls": {
      "label": "Max Concurrent Calls",
      "advanced": true
    },
    "maxDurationSeconds": {
      "label": "Max Call Duration (sec)",
      "advanced": true
    }
  },
  "configSchema": {
    "type": "object",
    "additionalProperties": false,
    "properties": {
      "enabled": {
        "type": "boolean"
      },
      "serve": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "port": {
            "type": "integer",
            "minimum": 1,
            "maximum": 65535
          },
          "bind": {
            "type": "string"
          },
          "path": {
            "type": "string"
          }
        }
      },
      "bridge": {
        "type": "object",
        "additionalProperties": false,
        "required": ["secret"],
        "properties": {
          "secret": {
            "type": "string",
            "minLength": 32
          }
        }
      },
      "authorization": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "mode": {
            "type": "string",
            "enum": ["disabled", "open", "allowlist", "tenant-only"]
          },
          "allowFrom": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "allowedTenants": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "allowPstn": {
            "type": "boolean"
          }
        }
      },
      "inbound": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "enabled": {
            "type": "boolean"
          },
          "greeting": {
            "type": "string"
          }
        }
      },
      "outbound": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "enabled": {
            "type": "boolean"
          },
          "ringTimeoutMs": {
            "type": "integer",
            "minimum": 5000,
            "maximum": 120000
          },
          "defaultMode": {
            "type": "string",
            "enum": ["notify", "conversation"]
          }
        }
      },
      "tts": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "model": {
            "type": "string"
          },
          "voice": {
            "type": "string"
          },
          "instructions": {
            "type": "string"
          },
          "speed": {
            "type": "number",
            "minimum": 0.25,
            "maximum": 4.0
          }
        }
      },
      "streaming": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "openaiApiKey": {
            "type": "string"
          },
          "sttModel": {
            "type": "string"
          },
          "silenceDurationMs": {
            "type": "integer",
            "minimum": 100,
            "maximum": 5000
          },
          "vadThreshold": {
            "type": "number",
            "minimum": 0,
            "maximum": 1
          },
          "sentenceMinChars": {
            "type": "integer",
            "minimum": 10,
            "maximum": 200
          },
          "sentenceMaxChars": {
            "type": "integer",
            "minimum": 50,
            "maximum": 500
          },
          "maxParallelTTS": {
            "type": "integer",
            "minimum": 1,
            "maximum": 5
          },
          "jitterBufferFrames": {
            "type": "integer",
            "minimum": 10,
            "maximum": 100
          },
          "thinkLevel": {
            "type": "string",
            "enum": ["off", "low", "medium", "high"]
          },
          "endOfTurnCue": {
            "type": "boolean"
          },
          "ttsMode": {
            "type": "string",
            "enum": ["auto", "realtime", "chunked"]
          }
        }
      },
      "realtime": {
        "type": "object",
        "additionalProperties": false,
        "description": "OpenAI Realtime API configuration (when ttsMode is 'realtime'). Uses Realtime API as THE agent.",
        "properties": {
          "model": {
            "type": "string",
            "description": "OpenAI Realtime model (default: gpt-4o-realtime-preview)"
          },
          "voice": {
            "type": "string",
            "description": "Voice for audio output (default: coral)"
          },
          "turnDetection": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "type": {
                "type": "string",
                "enum": ["server_vad", "none"]
              },
              "threshold": {
                "type": "number",
                "minimum": 0,
                "maximum": 1
              },
              "silenceDurationMs": {
                "type": "integer",
                "minimum": 100,
                "maximum": 2000
              },
              "prefixPaddingMs": {
                "type": "integer",
                "minimum": 0,
                "maximum": 1000
              }
            }
          },
          "tools": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "allow": {
                "type": "array",
                "items": { "type": "string" }
              },
              "deny": {
                "type": "array",
                "items": { "type": "string" }
              }
            }
          },
          "maxSessionDurationMs": {
            "type": "integer",
            "minimum": 60000,
            "maximum": 900000,
            "description": "Max session duration in ms. OpenAI has 15min (900000) limit. Default: 14min (840000)."
          }
        }
      },
      "responseModel": {
        "type": "string"
      },
      "responseSystemPrompt": {
        "type": "string"
      },
      "responseTimeoutMs": {
        "type": "integer",
        "minimum": 1000,
        "maximum": 300000
      },
      "maxConcurrentCalls": {
        "type": "integer",
        "minimum": 1,
        "maximum": 100
      },
      "maxDurationSeconds": {
        "type": "integer",
        "minimum": 60,
        "maximum": 86400
      }
    }
  }
}
